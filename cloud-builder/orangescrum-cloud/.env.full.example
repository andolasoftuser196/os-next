# OrangeScrum Cloud - Full Configuration Template
# This file contains ALL available environment variables
# For a simpler configuration, use .env.example instead
# Copy this file to .env and customize for your environment

# ============================================
# Project Configuration
# ============================================
COMPOSE_PROJECT_NAME=orangescrum-cloud

# ============================================
# Port Configuration (Host Bindings)
# ============================================
# PRODUCTION: Set APP_BIND_IP=127.0.0.1 when behind reverse proxy (nginx/Apache)
# DEVELOPMENT/DIRECT ACCESS: Set APP_BIND_IP=0.0.0.0 (ensure firewall rules are in place)

# OrangeScrum Application
APP_BIND_IP=127.0.0.1
APP_PORT=8080

# ============================================
# Database Configuration (External / Managed)
# ============================================
# These are used by the application to connect to your external database.
# For local dev, you can point this at the host machine.
DB_HOST=host.docker.internal
DB_PORT=5432
DB_USERNAME=orangescrum
DB_PASSWORD=changeme_in_production
DB_NAME=orangescrum

# Optional: allow password to be provided via mounted file
DB_PASSWORD_FILE=

# CRITICAL: Set a strong password before deployment!
# Generate a strong password with: openssl rand -base64 24
# Example: DB_PASSWORD=$(openssl rand -base64 24)

# ============================================
# Application Configuration
# ============================================
# Set to 'true' only for development/debugging
# CRITICAL: Must be 'false' in production for security
DEBUG=false

# Security salt for encryption and hashing (REQUIRED)
# CRITICAL: Generate a unique value before deployment!
# Generate with: openssl rand 64 | sha256sum | cut -d' ' -f1
# Example: SECURITY_SALT=$(openssl rand 64 | sha256sum | cut -d' ' -f1)
# using php -r "echo hash('sha256', random_bytes(64)) . \"\n\";"
SECURITY_SALT=__CHANGE_THIS_TO_RANDOM_STRING__

# Cache engine: 'file', 'redis', or 'memcached'
# Use 'file' for simple deployments without external cache services
# Use 'redis' for production (better performance, supports distributed cache)
CACHE_ENGINE=redis

# Queue engine: 'redis' or 'database'
# Use 'redis' for better performance in production
QUEUE_ENGINE=redis

# Queue URL (Redis format with TLS for AWS ElastiCache)
# Format: rediss://:password@host:port/database
# Example: rediss://:your-auth-token@master.xxxxx.use1.cache.amazonaws.com:6379/1
QUEUE_URL=

# Skip database migrations on startup (useful for production)
SKIP_MIGRATIONS=

# ============================================
# Redis Configuration (External)
# ============================================
# Point to your external Redis server or AWS ElastiCache
# Examples:
#   - External Redis: redis.example.com
#   - AWS ElastiCache: my-cluster.abc123.cache.amazonaws.com
#   - Local Redis: localhost (if running on host)
REDIS_HOST=localhost
REDIS_PORT=6379
# Set password if your Redis requires authentication
REDIS_PASSWORD=
REDIS_DATABASE=0
# Cache key prefix to avoid collisions with other apps
REDIS_PREFIX=cake_
# Connection timeout in seconds
REDIS_TIMEOUT=1

# AWS ElastiCache TLS Configuration (for encrypted Redis)
# Enable TLS/SSL for Redis connections (required for AWS ElastiCache with encryption)
REDIS_TLS_ENABLED=false
# Verify SSL peer certificate (set to false for self-signed certificates)
REDIS_TLS_VERIFY_PEER=false

# ============================================
# PHP Configuration
# ============================================
# PHP memory limit for script execution
PHP_MEMORY_LIMIT=512M
# Maximum POST data size (file uploads)
PHP_POST_MAX_SIZE=200M
# Maximum file upload size
PHP_UPLOAD_MAX_FILESIZE=200M
# Maximum script execution time (seconds)
PHP_MAX_EXECUTION_TIME=300

# ============================================
# Email Configuration
# ============================================
# Email transport: 'smtp' or 'sendgrid'
EMAIL_TRANSPORT=sendgrid

# SMTP Configuration (if EMAIL_TRANSPORT=smtp)
# Common SMTP ports: 25 (plain), 587 (TLS), 465 (SSL)
SMTP_HOST=
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_TLS=true

# SendGrid Configuration (if EMAIL_TRANSPORT=sendgrid)
# Get your API key from: https://app.sendgrid.com/settings/api_keys
EMAIL_API_KEY=

# Email addresses
FROM_EMAIL=noreply@orangescrum.local
NOTIFY_EMAIL=admin@orangescrum.local

# ============================================
# S3-Compatible Storage (REQUIRED)
# ============================================
# All file uploads are stored in S3-compatible storage (AWS S3, MinIO, DigitalOcean Spaces, etc.)
# This is required for production deployments

# Storage endpoint (required)
# Examples:
#   - AWS S3: https://s3.amazonaws.com
#   - DigitalOcean Spaces: https://nyc3.digitaloceanspaces.com
#   - MinIO: http://minio.example.com:9000
STORAGE_ENDPOINT=
# Get from your cloud provider's IAM/API keys section
STORAGE_ACCESS_KEY=
STORAGE_SECRET_KEY=

# Bucket name (required)
STORAGE_BUCKET=orangescrum

# AWS region (required for AWS S3, optional for others)
STORAGE_REGION=us-east-1

# Path-style endpoint (true for MinIO, false for AWS S3)
STORAGE_PATH_STYLE=false

# ============================================
# Session Configuration
# ============================================
# Session handler: 'cache' (Redis), 'database', or 'php'
# Use 'cache' for Redis-backed sessions (recommended for production)
SESSION_HANDLER=cache

# Session cookie domain (optional)
# Set to .yourdomain.com for cross-subdomain sessions
# Example: .ossiba.com to share sessions across v2 and v4 subdomains
SESSION_COOKIE_DOMAIN=

# Session cookie name (to avoid conflicts with other applications)
SESSION_COOKIE_NAME=PHPSESSID_V4

# Application URL Configuration (optional)
# Full base URL for the application (used for email links, etc.)
# Example: https://app.orangescrum.com
FULL_BASE_URL=

# ============================================
# Subscription Configuration
# ============================================
# Subscription key for license management
SUBSCRIPTION_KEY=Professional

# ============================================
# Critical Path Calculation Service
# ============================================
# Enable critical path functionality (requires external FastAPI service)
CRITICAL_PATH_ENABLED=true

# Base URL of the FastAPI critical path calculation service
# Examples:
#   - Production: https://criticalpath.yourdomain.com
#   - Development: http://localhost:9090
CRITICAL_PATH_BASE_URL=http://localhost:9090

# ============================================
# GitHub Integration (Optional)
# ============================================
# GitHub OAuth for repository integration
# Get credentials from: https://github.com/settings/developers

# GitHub Application Name
GITHUB_CLIENT_NAME=

# GitHub OAuth Client ID
GITHUB_CLIENT_ID=

# GitHub OAuth Client Secret
GITHUB_CLIENT_SECRET=

# GitHub OAuth Redirect URI
# Example: https://yourdomain.com/git/gitconnect
GITHUB_REDIRECT_URI=

# GitHub Webhook URL
# Example: https://yourdomain.com/githooks/updategithubevents
GITHUB_HOOK_URI=

# ============================================
# Cloud Storage Integrations (Optional)
# ============================================
# Enable cloud storage providers (Google Drive, Dropbox, OneDrive)
CLOUD_STORAGE_ENABLED=false

# Domain for OAuth callbacks (without protocol)
# Example: app.orangescrum.com
CLOUD_STORAGE_AUTH_DOMAIN=

# Google Drive API Configuration
# Get from: https://console.cloud.google.com
GOOGLE_DRIVE_API_KEY=

# ============================================
# Load Testing Configuration (Optional)
# ============================================
# Enable load testing endpoints
LOAD_TEST_ENABLED=false

# Secure token for load test endpoints
# Generate with: openssl rand -base64 32
LOAD_TEST_TOKEN=

# Auto-cleanup test data
LOAD_TEST_AUTO_CLEANUP=true

# Cleanup interval in hours
LOAD_TEST_CLEANUP_HOURS=24

# ============================================
# Advanced Database Configuration
# ============================================
# Enable database query logging
DB_LOG=false

# PostgreSQL schema (default: public)
DB_SCHEMA=public

# ============================================
# Advanced Redis Configuration
# ============================================
# Use persistent Redis connections
REDIS_PERSISTENT=false

# SSL/TLS verification for Redis (when using TLS)
REDIS_SSL_VERIFY_PEER=false

# ============================================
# Advanced Cache Configuration
# ============================================
# Cache key prefix
CACHE_PREFIX=cake_

# Memcached Configuration (if using memcached)
MEMCACHED_SERVER=localhost
MEMCACHED_PORT=11211
MEMCACHED_PREFIX=cake_
MEMCACHED_LOG=false

# ============================================
# Application Framework Settings
# ============================================
# Application name
APP_NAME=OrangeScrum

# Application environment (development, staging, production)
APP_ENV=production

# Default application locale
APP_DEFAULT_LOCALE=en_US

# Default timezone
APP_DEFAULT_TIMEZONE=UTC

# Application encoding
APP_ENCODING=UTF-8

# ============================================
# Advanced Logging Configuration
# ============================================
# Log file URLs (set to custom paths if needed)
LOG_DEBUG_URL=
LOG_ERROR_URL=
LOG_AUTH_URL=
LOG_EMAIL_URL=
LOG_QUERIES_URL=
LOG_CRON_URL=
LOG_GITSYNC_URL=
LOG_DUMMYDATA_URL=

# ============================================
# Advanced reCAPTCHA Settings
# ============================================
# reCAPTCHA widget size: compact, normal
RECAPTCHA_SIZE=normal

# reCAPTCHA theme: light, dark
RECAPTCHA_THEME=light

# ============================================
# Google reCAPTCHA (Optional)
# ============================================
# Enable reCAPTCHA for login/signup forms
# Get keys from: https://www.google.com/recaptcha/admin

# Enable reCAPTCHA
RECAPTCHA_ENABLED=false

# reCAPTCHA Site Key (public key for frontend)
RECAPTCHA_SITE_KEY=

# reCAPTCHA Secret Key (private key for backend)
RECAPTCHA_SECRET_KEY=

# reCAPTCHA Version: 'v2' (checkbox) or 'v3' (invisible)
RECAPTCHA_VERSION=v3

# Minimum score for v3 (0.0 to 1.0, lower = more likely bot)
RECAPTCHA_MIN_SCORE=0.5

# ============================================
# Google OAuth (Optional)
# ============================================
# Enable Google Sign-In for users
# Setup: https://console.cloud.google.com

# Enable Google OAuth
GOOGLE_OAUTH_ENABLED=false

# Google OAuth Client ID
GOOGLE_OAUTH_CLIENT_ID=

# Google OAuth Client Secret
GOOGLE_OAUTH_CLIENT_SECRET=

# OAuth Redirect URI (must match Google Cloud Console)
# Example: https://app.yourdomain.com/oauth/google/callback
GOOGLE_OAUTH_REDIRECT_URI=

# ============================================
# Cloud Storage Integrations (Optional)
# ============================================
# Enable Google Drive, Dropbox, OneDrive integrations
# See config/cloudstorage.example.php for detailed setup instructions

# Domain for OAuth callbacks
# CLOUD_STORAGE_AUTH_DOMAIN=app.orangescrum.com

# Google Drive OAuth (optional)
# GOOGLE_DRIVE_CLIENT_ID=
# GOOGLE_DRIVE_CLIENT_SECRET=
# GOOGLE_DRIVE_API_KEY=

# ============================================
# Queue Worker Configuration
# ============================================
# Maximum runtime for a single worker process (seconds)
WORKER_MAX_RUNTIME=1800
# Sleep time between queue checks (seconds)
WORKER_SLEEP=5

# ============================================
# V2/V4 Routing Configuration (Optional)
# ============================================
# CRITICAL: Generate a unique value if V4_ROUTING_ENABLED=true
# Generate with: openssl rand -base64 32
# This must match the V4_API_KEY in the v2 application
# Example: V2_ROUTING_API_KEY=$(openssl rand -base64 32)
V2_ROUTING_API_KEY=

# Base URL for the V2 application (common login page)
# Should NOT include trailing slash
# Examples:
#   - Production: https://app.ossiba.com
#   - Development: http://localhost:8000
V2_BASE_URL=https://app.ossiba.com

# Base URL for the V4 application
# Should NOT include trailing slash
# Examples:
#   - Production: https://v4.ossiba.com
#   - Development: http://localhost:8080
V4_BASE_URL=https://v4.ossiba.com

# Auto-login token expiration time (in minutes)
V2_ROUTING_TOKEN_EXPIRATION=15

# API request timeout (in seconds)
V2_ROUTING_TIMEOUT=10
API request timeout (in seconds)
V2_ROUTING_TIMEOUT=10

# SSL verification for API requests (set to false only in development)
V2_ROUTING_SSL_VERIFY=true

# 
# SSL verification for API requests (set to false only in development)
V2_ROUTING_SSL_VERIFY=true

# Enable V4 routing (routing users from v4 to v2 common login page)
# Set to false when v4 is deployed as a standalone application
V4_ROUTING_ENABLED=false

# ============================================
# Service URLs (After Deployment)
# ============================================
# OrangeScrum App:       http://localhost:8080
# Redis (if enabled):    127.0.0.1:6379

# ============================================
# Deployment Notes
# ============================================
# 1. If ports are occupied, adjust the port numbers above
# 2. The deploy script will check for port availability
# 3. To deploy:
#    ./deploy.sh
# 4. To deploy with custom ports:
#    ./deploy.sh --app-port 8080 --pg-port 5433
# 5. To check prerequisites:
#    ./deploy.sh --check
