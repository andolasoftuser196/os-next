# OrangeScrum Cloud - Essential Configuration
# Copy this file to .env and customize for your environment
# For advanced configuration options, see full.env.example

# ============================================
# Project Configuration
# ============================================
COMPOSE_PROJECT_NAME=orangescrum-cloud

# ============================================
# Port Configuration (Host Bindings)
# ============================================
# PRODUCTION: Set APP_BIND_IP=127.0.0.1 when behind reverse proxy
# DEVELOPMENT: Set APP_BIND_IP=0.0.0.0 (ensure firewall rules are in place)
APP_BIND_IP=127.0.0.1
APP_PORT=8080

# ============================================
# Database Configuration (External PostgreSQL)
# ============================================
DB_HOST=host.docker.internal
DB_PORT=5432
DB_USERNAME=orangescrum
DB_PASSWORD=changeme_in_production
DB_NAME=orangescrum

# CRITICAL: Set a strong password before deployment!
# Generate with: openssl rand -base64 24

# ============================================
# Application Configuration
# ============================================
# Debug mode (MUST be false in production)
DEBUG=false

# Security salt for encryption (REQUIRED - CHANGE THIS!)
# Generate with: openssl rand -hex 32 | xargs -I {} sh -c 'echo -n "{}" | sha256sum | cut -d" " -f1'
# Or use: php -r 'echo hash("sha256", bin2hex(random_bytes(32)));'
SECURITY_SALT=__CHANGE_THIS_TO_RANDOM_STRING__

# ============================================
# Cache & Queue Configuration
# ============================================
# Cache engine: 'file' or 'redis' (redis recommended for production)
CACHE_ENGINE=redis

# Queue engine: 'redis' or 'database' (redis recommended)
QUEUE_ENGINE=redis

# Redis Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DATABASE=0

# ============================================
# Email Configuration
# ============================================
# Email transport: 'smtp' or 'sendgrid'
EMAIL_TRANSPORT=sendgrid

# SendGrid API Key (if using sendgrid)
EMAIL_API_KEY=

# SMTP Configuration (if using smtp)
SMTP_HOST=
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_TLS=true

# Email addresses
FROM_EMAIL=noreply@orangescrum.local
NOTIFY_EMAIL=admin@orangescrum.local

# ============================================
# S3-Compatible Storage (REQUIRED for file uploads)
# ============================================
# Storage endpoint (AWS S3, DigitalOcean Spaces, MinIO, etc.)
STORAGE_ENDPOINT=
STORAGE_ACCESS_KEY=
STORAGE_SECRET_KEY=
STORAGE_BUCKET=orangescrum
STORAGE_REGION=us-east-1

# ============================================
# Session Configuration
# ============================================
SESSION_HANDLER=cache
SESSION_COOKIE_DOMAIN=
SESSION_COOKIE_NAME=PHPSESSID_V4

# ============================================
# Application URL
# ============================================
# Full base URL for the application (used in emails, etc.)
FULL_BASE_URL=

# ============================================
# Optional Features
# ============================================
# Google reCAPTCHA
RECAPTCHA_ENABLED=false
RECAPTCHA_SITE_KEY=
RECAPTCHA_SECRET_KEY=

# Google OAuth
GOOGLE_OAUTH_ENABLED=false
GOOGLE_OAUTH_CLIENT_ID=
GOOGLE_OAUTH_CLIENT_SECRET=

# Critical Path Calculation Service
CRITICAL_PATH_ENABLED=true
CRITICAL_PATH_BASE_URL=http://localhost:9090

# ============================================
# V2/V4 Routing Configuration (REQUIRED)
# ============================================
# API Key for v2 application authentication
# CRITICAL: Generate a unique value and keep it secret
# Generate with: openssl rand -base64 32
V2_ROUTING_API_KEY=

# Base URL for the V2 application (common login page)
# Example: https://app.ossiba.com
V2_BASE_URL=https://app.ossiba.com

# Base URL for the V4 application
# Example: https://v4.ossiba.com
V4_BASE_URL=https://v4.ossiba.com

# Auto-login token expiration (in minutes)
V2_ROUTING_TOKEN_EXPIRATION=15

# API request timeout (in seconds)
V2_ROUTING_TIMEOUT=10

# SSL verification for API requests (false only in development)
V2_ROUTING_SSL_VERIFY=true

# Enable V4 routing (set to false for standalone deployment)
V4_ROUTING_ENABLED=false

# ============================================
# Subscription Configuration (REQUIRED)
# ============================================
# License/subscription key
SUBSCRIPTION_KEY=Professional

# ============================================
# Queue Worker Configuration
# ============================================
# Maximum runtime for a single worker process (seconds)
WORKER_MAX_RUNTIME=1800

# Sleep time between queue checks (seconds)
WORKER_SLEEP=5

# ============================================
# GitHub Integration (Optional)
# ============================================
# Setup: https://github.com/settings/developers
# Create OAuth App for GitHub integration
GITHUB_CLIENT_NAME=
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_REDIRECT_URI=
GITHUB_HOOK_URI=

# ============================================
# GitSync Plugin Configuration (Optional)
# ============================================
# GitHub GitSync (if using GitSync plugin)
GITHUB_WEBHOOK_SECRET=

# GitLab GitSync
GITLAB_CLIENT_NAME=
GITLAB_CLIENT_ID=
GITLAB_CLIENT_SECRET=
GITLAB_REDIRECT_URI=
GITLAB_INSTANCE_URL=https://gitlab.com
GITLAB_WEBHOOK_SECRET=

# Bitbucket GitSync
BITBUCKET_CLIENT_NAME=
BITBUCKET_CLIENT_ID=
BITBUCKET_CLIENT_SECRET=
BITBUCKET_REDIRECT_URI=
BITBUCKET_WEBHOOK_SECRET=

# ============================================
# Stripe Payment Integration (Optional)
# ============================================
# Setup: https://dashboard.stripe.com/apikeys
STRIPE_PUBLISHABLE_KEY=
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_CURRENCY=usd

# ============================================
# Cloud Storage Integrations (Dropbox, OneDrive)
# ============================================
# Domain for OAuth callbacks
CLOUD_STORAGE_AUTH_DOMAIN=

# Dropbox Integration
# Setup: https://www.dropbox.com/developers/apps
DROPBOX_CLIENT_ID=
DROPBOX_CLIENT_SECRET=
DROPBOX_ENABLED=false

# OneDrive Integration
# Setup: https://portal.azure.com/
ONEDRIVE_CLIENT_ID=
ONEDRIVE_CLIENT_SECRET=
ONEDRIVE_TENANT_ID=common
ONEDRIVE_ENABLED=false

# ============================================
# Memcached Configuration (Alternative to Redis)
# ============================================
# Use if CACHE_ENGINE=memcached
MEMCACHED_SERVER=127.0.0.1
MEMCACHED_PORT=11211
MEMCACHED_PREFIX=cake_
MEMCACHED_LOG=true

# ============================================
# Advanced Cache Configuration
# ============================================
# General cache prefix for file-based cache
CACHE_PREFIX=cake_

# Redis persistent connections (set to true for production after testing)
REDIS_PERSISTENT=false

# reCAPTCHA additional settings
RECAPTCHA_THEME=light
RECAPTCHA_SIZE=normal

# ============================================
# Database Secrets (Docker Secrets Support)
# ============================================
# Alternative to DB_PASSWORD - read from file
# DB_PASSWORD_FILE=/run/secrets/db_password
